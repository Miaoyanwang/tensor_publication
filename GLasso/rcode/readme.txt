# Brain tissue analysis
# Origin: 03/07/21 Lastest Update: 03/12/21

### Outline ###
To go through the brain tissue analysis, run the following scripts in order:

1.prepare_input.R ; 2.pipeline.m ; 3.plot.R: 

### Prepare Input ###
prepare_input.R: a R code to prepare the sample covariance matrices input to the algorithm.

Dependency: 
 - corrected_expression_list_noY.RData: the raw gtex data
 - functions.R: functions to generate the sample covariance matrices and figures.

Output: 
 - ss_data.mat: a collection of sample covariance matrices for 13 brain tissues. 
 - ss_f01.jpeg - ss_f13.jpeg: 13 jpeg figures visualize the sample covariance matrices. 
 - nvector.csv: a csv file recording the sample size for each brain tissue.

### Apply Algorihtm ###
pipeline.m: a Matlab code to apply the main algorithm to the gtex data.

Dependency: 
 - SCENT_tucker1_v6_2.m, logdet.m: main Matlab algorithms.
 - ss_data.mat, nvector.csv: prepared inputs generated by prepare_input.R.
  
Output: 
 - U.csv: the membership matrix.
 - Theta0.csv: the precision matrix for global connection. 
 - Theta_l.csv,l = 1,...,r: the tissue specific components in the precision matrix.
 - Obj_curve.csv: the trajectory of objective value.

## Tuning parameters ##

The default tuning parameters in pipeline.m are:
 - r = 3
 - rho (penalty parameter) = 1500
 - option.Niter (max iteration) = 50
 - option.tol (stopping threshold) = 1
 - option.initial (initialization) = 1 (HOSVD)

The default setting is the best setting for ss_data.mat is r = 3, rho = 1500. 

## Results ##

Results obtained by the algorithm are stored in folder results, where
 
 - r3rho1500: has the results with ss_data.mat under r = 3, rho = 1500.

###  Visualization ### 
plot.R: the R code to make the vertical bar plots in network.pdf and prepare the node file for the cytoscape network.

Dependency:
 - U.csv, Theta0.csv, Theta_l.csv: generated by pipeline.m.


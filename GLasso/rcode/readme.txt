# Brain tissue analysis
# Origin: 03/07/21 Lastest Update: 03/21/21

### Outline ###
To go through the brain tissue analysis, run the following scripts in order:

1.prepare_input.R ; 2.pipeline.m ; 3.plot.R: 

### Prepare Input ###
prepare_input.R: a R code to prepare the sample covariance matrices input to the algorithm.

Dependency: 
 - corrected_expression_list_noY.RData: the raw gtex data
 - functions.R: functions to generate the sample covariance matrices and figures.

Output: 
 - ss_data.mat: a collection of sample covariance matrices for 13 brain tissues with their gene name, tissue name, and the sample size for each tissue.
 - ss_f01.jpeg - ss_f13.jpeg: 13 jpeg figures visualize the sample covariance matrices. 
 

### Apply Algorihtm ###
pipeline.m: a Matlab code to apply the main algorithm to the gtex data.

Dependency: 
 - SCENT_tucker1_v6_2.m, logdet.m: main Matlab algorithms.
 - ss_data.mat: prepared inputs generated by prepare_input.R.
  
Output: 
 - result.mat: records 1) membership matrix; 2) Theta0, precision matrix for global connection; 3) Theta_l, l = 1,...,r, tissue specific components in the precision matrix; 4) trajectory of objective value; 5) tissue name; 6) gene name for the precision matrices.


## Tuning parameters ##

The default tuning parameters in pipeline.m are:
 - r = 3
 - rho (penalty parameter) = 1500
 - option.Niter (max iteration) = 50
 - option.tol (stopping threshold) = 1
 - option.initial (initialization) = 1 (HOSVD)

The default setting is the best setting for ss_data.mat is r = 3, rho = 1500. 

## Results ##

Results obtained by the algorithm are stored in folder results, where
 
 - r3rho1500: has the results with ss_data.mat under r = 3, rho = 1500.

###  Visualization ### 
plot.R: the R code to make the figure network_500 with package igraph.

Dependency:
 - result.mat: generated by pipeline.m.

